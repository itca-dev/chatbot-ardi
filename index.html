<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente Virtual</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-size: 16px;
        }

        :root {
            --organa-green: #2ecc71;
            --organa-green-dark: #27ae60;
            --organa-green-light: #e6f5ea;
            --organa-dark-text: #333333;
            --organa-light-text: #697A80;
            --organa-white: #ffffff;
            --organa-grey: #f0f0f0;
        }
        
        #chatbot-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background-color: var(--organa-green);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        #chatbot-button:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.35);
        }

        #chatbot-popup {
            position: fixed;
            bottom: 6rem;
            right: 2rem;
            width: 350px;
            max-height: 480px;
            height: 480px;
            background-color: var(--organa-white);
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            transform: scale(0.8) translateY(20px);
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease-in-out;
            z-index: 999;
        }

        #chatbot-popup.popup-visible {
            transform: scale(1) translateY(0);
            opacity: 1;
            pointer-events: auto;
        }
        
        .popup-header {
            background-color: var(--organa-green);
            color: white;
            padding: 0.75rem 1.25rem;
            border-top-left-radius: 16px;
            border-top-right-radius: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .popup-header h3 {
            font-size: 1rem;
            font-weight: 600;
            margin: 0;
        }
        .popup-header p {
            font-size: 0.7rem;
            opacity: 0.9;
        }
        
        #close-popup {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            line-height: 1;
        }

        @media (max-width: 767px) {
            #chatbot-popup {
                width: 90vw;
                height: 80vh;
                max-width: none;
                max-height: none;
                bottom: 50%;
                right: 50%;
                transform: translate(50%, 50%) scale(0.8);
                border-radius: 16px;
            }

            #chatbot-popup.popup-visible {
                transform: translate(50%, 50%) scale(1);
            }
        }
        
        .flow-step {
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
        .step-hidden {
            opacity: 0;
            transform: scale(0.95);
            pointer-events: none;
        }
        .step-visible {
            opacity: 1;
            transform: scale(1);
            position: static;
        }
        .option-button {
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 0.85rem;
        }
        .option-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .flow-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .flow-message {
            background-color: var(--organa-green-light);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            text-align: left;
            position: relative;
            font-size: 0.9rem;
        }
        .flow-message:before {
            content: "";
            position: absolute;
            bottom: 0;
            left: 10px;
            width: 0;
            height: 0;
            border: 10px solid transparent;
            border-right-color: var(--organa-green-light);
            border-bottom-color: var(--organa-green-light);
            border-bottom-left-radius: 5px;
            transform: translateY(100%);
        }
        .flow-options-container {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .flow-content {
            height: calc(100% - 6rem);
            overflow-y: auto;
            padding: 1rem;
        }
        .flow-options-buttons {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .flow-options-buttons .option-button {
            background-color: var(--organa-green);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .flow-options-buttons .option-button:hover {
            background-color: var(--organa-green-dark);
        }
        .flow-text-info {
            background-color: var(--organa-grey);
            border-radius: 8px;
            padding: 1rem;
            font-size: 0.85rem;
        }
        .flow-text-info ul {
            list-style: none;
            padding: 0;
        }
        .flow-text-info ul li {
            margin-bottom: 0.5rem;
        }
        .flow-text-info ul li i {
            width: 1.25rem;
        }

    </style>
</head>
<body>
    <!-- Bot√≥n flotante para el chatbot -->
    <button id="chatbot-button">
        <i class="fas fa-comment-dots text-2xl"></i>
    </button>

    <!-- Pop-up del chatbot -->
    <div id="chatbot-popup">
        <div class="popup-header">
            <div class="flex items-center space-x-2">
                <i class="fas fa-seedling text-base"></i>
                <div>
                    <h3 class="text-sm">Tu asistente virtual</h3>
                    <p class="text-xs">Disponible</p>
                </div>
            </div>
            <button id="close-popup">&times;</button>
        </div>
        <div class="w-full h-full bg-white flex flex-col">
            <div id="flow-content" class="relative w-full h-full overflow-y-auto">
        
                <!-- Step: Initial -->
                <div id="step-start" class="flow-step step-visible">
                    <div class="flow-message">
                        <p class="text-sm">¬°Hola! Soy el asistente virtual de Ardicorp. ¬øEn qu√© puedo ayudarte hoy?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-reseller" class="option-button">
                            <span>üõí Comprar para revender</span>
                        </button>
                        <button data-target="step-user" class="option-button">
                            <span>üíª Quiero usar</span>
                        </button>
                        <button data-target="step-info" class="option-button">
                            <span>‚ÑπÔ∏è Informaci√≥n general</span>
                        </button>
                        <button data-target="step-operator" class="option-button">
                            <span>üìû Contactar con un Asesor</span>
                        </button>
                        <button data-target="step-profile-info" class="option-button">
                            <span>üë§ Acceder a mi Portal de Clientes</span>
                        </button>
                    </div>
                </div>
                
                <!-- Step: Reseller Type -->
                <div id="step-reseller" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üõí Comprar para revender: ¬øQu√© tipo de cliente eres?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-ruc-validation" class="option-button">Ferreter√≠a</button>
                        <button data-target="step-ruc-validation-dist" class="option-button">Distribuidor</button>
                        <button data-target="step-ruc-validation-dist" class="option-button">Cotizador</button>
                    </div>
                </div>
                
                <!-- Step: RUC Validation (Ferreteria) -->
                <div id="step-ruc-validation" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">Ingresa RUC (Ferreter√≠a) y se valida en SAP. ¬øExiste?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-ruc-exists" class="option-button bg-green-600">S√≠</button>
                        <button data-target="step-ruc-not-exists-ferreteria" class="option-button bg-red-500">No</button>
                    </div>
                </div>
                
                <!-- Step: RUC Validation (Distribuidor/Cotizador) -->
                <div id="step-ruc-validation-dist" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">Ingresa RUC (Distribuidor/Cotizador) y se valida en SAP. ¬øExiste?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-ruc-exists" class="option-button bg-green-600">S√≠</button>
                        <button data-target="step-ruc-not-exists-dist" class="option-button bg-red-500">No</button>
                    </div>
                </div>

                <!-- Step: RUC Exists (Buttons) -->
                <div id="step-ruc-exists" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">‚úÖ RUC V√°lido. Se ofrecen las siguientes opciones al cliente:</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-download-app" class="option-button bg-blue-500">
                            <span>‚úÖ Descargar App aqu√≠</span>
                        </button>
                        <button data-target="step-contact-vendedor" class="option-button bg-blue-500">
                            <span>üì≤ Contactar con tu Vendedor</span>
                        </button>
                        <button data-target="step-contact-supervisor" class="option-button bg-blue-500">
                            <span>üßë‚Äçüíº Contactar con el Supervisor</span>
                        </button>
                    </div>
                </div>

                <!-- Step: Download App -->
                <div id="step-download-app" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">Descargar App</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <a href="https://play.google.com/store/apps/details?id=com.example.app" class="option-button bg-gray-500" target="_blank" rel="noopener noreferrer">
                            <span>üì± Android App Store</span>
                        </a>
                        <a href="https://apps.apple.com/us/app/example/id123456789" class="option-button bg-gray-500" target="_blank" rel="noopener noreferrer">
                            <span>üçé iOS App Store</span>
                        </a>
                    </div>
                </div>

                <!-- Step: Contact Vendedor -->
                <div id="step-contact-vendedor" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üì≤ Datos del Vendedor</p>
                    </div>
                    <div class="flow-text-info mt-4">
                        <p class="font-bold text-sm">Nombre:</p>
                        <p class="mb-2 text-sm">Juan P√©rez</p>
                        <p class="font-bold text-sm">Tel√©fono:</p>
                        <p class="mb-2 text-sm">+51 987 654 321</p>
                        <p class="font-bold text-sm">Correo:</p>
                        <p class="text-sm">juan.perez@empresa.com</p>
                    </div>
                    <a href="https://wa.me/51987654321" class="option-button mt-6 bg-green-500" target="_blank">
                        <span>üí¨ Contactar por WhatsApp</span>
                    </a>
                </div>

                <!-- Step: Contact Supervisor -->
                <div id="step-contact-supervisor" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üßë‚Äçüíº Datos del Supervisor</p>
                    </div>
                    <div class="flow-text-info mt-4">
                        <p class="font-bold text-sm">Nombre:</p>
                        <p class="mb-2 text-sm">Mar√≠a Garc√≠a</p>
                        <p class="font-bold text-sm">Tel√©fono:</p>
                        <p class="mb-2 text-sm">+51 912 345 678</p>
                        <p class="font-bold text-sm">Correo:</p>
                        <p class="text-sm">maria.garcia@empresa.com</p>
                    </div>
                    <a href="https://wa.me/51912345678" class="option-button mt-6 bg-green-500" target="_blank">
                        <span>üí¨ Contactar por WhatsApp</span>
                    </a>
                </div>
                
                <!-- Step: RUC Not Exists (Ferreteria) -->
                <div id="step-ruc-not-exists-ferreteria" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">‚ùå RUC No Encontrado. Derivamos tu consulta a nuestro equipo.</p>
                    </div>
                    <a href="https://wa.me/51972969129" class="option-button mt-6 bg-green-500" target="_blank">
                        <span>‚û°Ô∏è Derivar al WhatsApp Call Center</span>
                    </a>
                </div>

                <!-- Step: RUC Not Exists (Distribuidor) -->
                <div id="step-ruc-not-exists-dist" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">‚ùå RUC No Encontrado. Derivamos tu consulta a nuestro equipo.</p>
                    </div>
                    <a href="https://wa.me/51943903278" class="option-button mt-6 bg-green-500" target="_blank">
                        <span>‚û°Ô∏è Derivar al WhatsApp Showroom</span>
                    </a>
                </div>
                
                <!-- Step: User Type -->
                <div id="step-user" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üíª Quiero usar: ¬øEres empresa o persona natural?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-user-empresa" class="option-button">üè¢ Empresa privada</button>
                        <button data-target="step-user-natural" class="option-button">üôã Persona natural</button>
                    </div>
                </div>
                
                <!-- Step: User Empresa -->
                <div id="step-user-empresa" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üè¢ Empresa Privada</p>
                    </div>
                    <div class="flow-text-info mt-4">
                        <p class="font-bold text-sm">‚û°Ô∏è Derivar a WhatsApp KAM 998114864</p>
                    </div>
                </div>

                <!-- Step: User Natural -->
                <div id="step-user-natural" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üôã Persona Natural</p>
                    </div>
                    <p class="text-gray-600 mb-2 text-sm mt-4">üìç Se solicita Ciudad y Distrito.</p>
                    <p class="text-gray-600 mb-6 text-sm">üîç Luego, se pide ingresar producto (Nombre o SKU).</p>
                    <div class="flow-options-buttons">
                        <button data-target="step-product-sku" class="option-button">Ingres√≥ SKU</button>
                        <button data-target="step-product-keyword" class="option-button">Ingres√≥ Palabra Clave</button>
                    </div>
                </div>
                
                <!-- Step: Product SKU -->
                <div id="step-product-sku" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">SKU Ingresado. Se muestra el nombre del producto y se verifica disponibilidad. ¬øDisponible?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-product-available" class="option-button bg-green-600">S√≠</button>
                        <button data-target="step-product-not-available" class="option-button bg-red-500">No</button>
                    </div>
                </div>

                <!-- Step: Product Keyword -->
                <div id="step-product-keyword" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">Palabra Clave Ingresada</p>
                    </div>
                    <p class="text-gray-600 mb-2 text-sm mt-4">üìÇ Se solicita Categor√≠a + Tipo, Color o Caracter√≠stica.</p>
                    <p class="text-gray-600 mb-6 text-sm">üìã Se muestra una lista de productos relacionados. üëâ Usuario selecciona un producto y se verifica disponibilidad. ¬øDisponible?</p>
                    <div class="flow-options-buttons">
                        <button data-target="step-product-available" class="option-button bg-green-600">S√≠</button>
                        <button data-target="step-product-not-available" class="option-button bg-red-500">No</button>
                    </div>
                </div>

                <!-- Step: Product Available -->
                <div id="step-product-available" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">‚úÖ Producto Disponible</p>
                    </div>
                    <p class="text-gray-600 mb-4 text-sm mt-4">Se aplica un algoritmo de priorizaci√≥n para encontrar las mejores opciones:</p>
                    <div class="flow-text-info mt-4">
                        <p class="text-sm"><strong>Filtro 1:</strong> Compras √∫ltimos 15 d√≠as</p>
                        <p class="text-sm"><strong>Filtro 2:</strong> Distrito</p>
                        <p class="text-sm"><strong>Filtro 3:</strong> Cantidad de compra</p>
                        <p class="text-sm"><strong>Filtro 4:</strong> Categor√≠a del ferretero (Gold++, Gold+, etc.)</p>
                    </div>
                    <p class="text-gray-600 mt-4 font-semibold text-sm">üè™ Se muestran hasta 4 ferreter√≠as priorizadas al comprador.</p>
                </div>
                
                <!-- Step: Product Not Available -->
                <div id="step-product-not-available" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">‚ùå Producto No Disponible</p>
                    </div>
                    <div class="flow-text-info mt-4">
                        <p class="font-bold text-sm">‚û°Ô∏è Derivar al WhatsApp Showroom</p>
                    </div>
                </div>

                <!-- Step: General Info -->
                <div id="step-info" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">‚ÑπÔ∏è Informaci√≥n General</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <a href="https://acortar.link/EUh58w" class="option-button" target="_blank" rel="noopener noreferrer" download>
                            <span>üì• Descargar Cat√°logo de Productos</span>
                        </a>
                        <button data-target="step-contact-hours" class="option-button">
                            <span>‚è∞ Ver Canales y Horarios de Atenci√≥n</span>
                        </button>
                        <button data-target="step-location" class="option-button">
                            <span>üìç Ubicaci√≥n</span>
                        </button>
                        <a href="https://b2bdev.ardiles.pe/atencion-cliente/preguntas-frecuentes" target="_blank" class="option-button">
                            <span>‚ùì Preguntas Frecuentes</span>
                        </a>
                    </div>
                </div>
                
                <!-- Step: Location -->
                <div id="step-location" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üìç Ubicaci√≥n</p>
                    </div>
                    <div class="flow-text-info mt-4">
                        <h3 class="font-bold text-sm text-gray-800 mb-2">Direcci√≥n</h3>
                        <p class="text-sm text-gray-600">Av. Santa Mar√≠a 230 Urb. La Aurora - Ate, Lima</p>
                    </div>
                    <div class="flow-options-buttons mt-6">
                        <a href="https://www.google.com/maps/dir/?api=1&destination=Av.Santa+Mar%C3%ADa+230+Urb.+La+Aurora+-+Ate,+Lima" target="_blank" class="option-button bg-blue-500" rel="noopener noreferrer">
                            <span>üó∫Ô∏è Google Maps</span>
                        </a>
                        <a href="https://www.waze.com/ul?q=Av.Santa+Mar%C3%ADa+230+Urb.+La+Aurora+-+Ate,+Lima" target="_blank" class="option-button bg-blue-500" rel="noopener noreferrer">
                            <span>üöó Waze</span>
                        </a>
                    </div>
                </div>

                <!-- Step: Contact Hours -->
                <div id="step-contact-hours" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">‚è∞ Canales y Horarios de Atenci√≥n</p>
                    </div>
                    <div class="flow-text-info mt-4">
                        <h3 class="font-bold text-gray-800 mb-2 text-sm">Horario</h3>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li>Lunes - Viernes: 9:00 AM - 5:00 PM</li>
                            <li>S√°bado: 9:00 AM - 12:00 PM</li>
                        </ul>
                    </div>
                    <div class="flow-text-info mt-4">
                        <h3 class="font-bold text-gray-800 mb-2 text-sm">Ventas y Cotizaciones</h3>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li><i class="fas fa-phone mr-2 text-green-500"></i>Tel√©fono: (01) 319 - 0660</li>
                            <li><i class="fab fa-whatsapp mr-2 text-green-500"></i>WhatsApp: 943 903 278, 947 647 163</li>
                            <li><i class="fas fa-envelope mr-2 text-green-500"></i>Email: ventas@ardicorp.pe</li>
                        </ul>
                    </div>
                    <div class="flow-text-info mt-4">
                        <h3 class="font-bold text-gray-800 mb-2 text-sm">Servicio al Cliente</h3>
                        <ul class="text-sm text-gray-600 space-y-1">
                            <li><i class="fas fa-phone mr-2 text-green-500"></i>Tel√©fono: (01) 319 - 0660</li>
                            <li><i class="fab fa-whatsapp mr-2 text-green-500"></i>WhatsApp: 972 969 129</li>
                            <li><i class="fas fa-envelope mr-2 text-green-500"></i>Email: servicio.clientes@ardicorp.pe</li>
                        </ul>
                    </div>
                </div>

                <!-- Step: Operator -->
                <div id="step-operator" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üìû Contactar con un Asesor: Selecciona el √°rea</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-operator-whatsapp-derivation" class="option-button" data-whatsapp-number="51943903278">Ventas / Cotizaciones</button>
                        <button data-target="step-operator-whatsapp-derivation" class="option-button" data-whatsapp-number="51972969129">Atenci√≥n al Cliente</button>
                        <button data-target="step-operator-whatsapp-derivation" class="option-button" data-whatsapp-number="51981145493">Cobranza</button>
                        <button data-target="step-operator-whatsapp-derivation" class="option-button" data-whatsapp-number="51981145493">Contacto con Recepci√≥n</button>
                    </div>
                </div>
                
                <!-- Step: Operator Derivation to WhatsApp -->
                <div id="step-operator-whatsapp-derivation" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">Derivaci√≥n a Operador</p>
                    </div>
                    <p class="text-gray-600 mb-6 text-sm mt-4">Ser√°s redirigido a un chat de WhatsApp con el √°rea seleccionada.</p>
                    <a href="#" id="whatsapp-link" class="option-button mt-6 bg-green-500" target="_blank">
                        <span>üí¨ Contactar por WhatsApp</span>
                    </a>
                </div>
                
                <!-- Step: Profile Info (New step) -->
                <div id="step-profile-info" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üë§ Acceder a mi Portal de Clientes</p>
                    </div>
                    <p class="text-gray-600 mb-6 text-sm mt-4">Al ingresar a tu perfil de cliente, podr√°s:</p>
                    <ul class="text-left text-gray-700 space-y-2 mb-6 max-w-sm mx-auto text-sm">
                        <li class="flex items-center space-x-2"><i class="fas fa-truck-fast text-blue-500"></i><span>Creaci√≥n y seguimiento de pedidos.</span></li>
                        <li class="flex items-center space-x-2"><i class="fas fa-clipboard-list text-blue-500"></i><span>Creaci√≥n y seguimiento de reclamos.</span></li>
                        <li class="flex items-center space-x-2"><i class="fas fa-file-invoice text-blue-500"></i><span>Consultar el estado de tu cuenta.</span></li>
                    </ul>
                    <a href="https://b2bdev.ardiles.pe/distribuidores/login" target="_blank" class="option-button mt-4 bg-blue-500">
                        <span>‚û°Ô∏è Ir al portal de cliente</span>
                    </a>
                </div>

                <!-- Step: Profile -->
                <div id="step-profile" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üë§ Perfil del Cliente: ¬øQu√© deseas consultar?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-profile-result" class="option-button">üìë Estado de cuenta</button>
                        <button data-target="step-profile-result" class="option-button">üì¶ Seguimiento de pedidos</button>
                        <button data-target="step-profile-claims" class="option-button">üìù Reclamos</button>
                    </div>
                </div>

                <!-- Step: Profile Claims -->
                <div id="step-profile-claims" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">üìù Reclamos: ¬øQu√© acci√≥n deseas realizar?</p>
                    </div>
                    <div class="flow-options-buttons mt-4">
                        <button data-target="step-profile-result" class="option-button">Registrar reclamo</button>
                        <button data-target="step-profile-result" class="option-button">Consultar reclamo</button>
                    </div>
                </div>
                
                <!-- Step: Profile Result -->
                <div id="step-profile-result" class="flow-step step-hidden">
                    <div class="flow-message">
                        <p class="text-sm">Consulta de Perfil</p>
                    </div>
                    <div class="flow-text-info mt-4">
                        <p class="font-bold text-sm">‚úÖ Se muestra la informaci√≥n solicitada.</p>
                        <p class="text-sm">(Estado de cuenta, tracking, formulario/lista de reclamos, etc.)</p>
                    </div>
                </div>
            </div>
            <div class="p-4 bg-gray-100 border-t rounded-b-xl flex justify-center space-x-4">
                <button id="back-button" class="bg-gray-400 text-white font-bold py-2 px-6 rounded-full hover:bg-gray-500 transition-colors text-sm" style="display: none;">
                    Atr√°s
                </button>
                <button id="home-button" class="bg-gray-600 text-white font-bold py-2 px-6 rounded-full hover:bg-gray-700 transition-colors text-sm">
                    Volver al Inicio
                </button>
            </div>
        </div>
    </div>

    <script>
        const chatbotButton = document.getElementById('chatbot-button');
        const chatbotPopup = document.getElementById('chatbot-popup');
        const closePopupButton = document.getElementById('close-popup');

        chatbotButton.addEventListener('click', () => {
            chatbotPopup.classList.toggle('popup-visible');
        });

        closePopupButton.addEventListener('click', () => {
            chatbotPopup.classList.remove('popup-visible');
        });

        const flowContent = document.getElementById('flow-content');
        const allSteps = flowContent.querySelectorAll('.flow-step');
        const backButton = document.getElementById('back-button');
        const homeButton = document.getElementById('home-button');
        let historyStack = ['step-start'];

        const renderStep = (targetId) => {
            allSteps.forEach(step => {
                step.classList.add('step-hidden');
                step.classList.remove('step-visible');
            });
            const targetStep = document.getElementById(targetId);
            if (targetStep) {
                targetStep.classList.remove('step-hidden');
                targetStep.classList.add('step-visible');
            }
            updateButtonVisibility();
        };

        const navigateToStep = (targetId) => {
            historyStack.push(targetId);
            renderStep(targetId);
        };
        
        const goBack = () => {
            if (historyStack.length > 1) {
                historyStack.pop();
                const previousStepId = historyStack[historyStack.length - 1];
                renderStep(previousStepId);
            }
        };
        
        const goToHome = () => {
            historyStack = ['step-start'];
            renderStep('step-start');
        };

        const updateButtonVisibility = () => {
            backButton.style.display = historyStack.length > 1 ? 'inline-block' : 'none';
        };

        flowContent.addEventListener('click', (e) => {
            const target = e.target.closest('button[data-target]');
            if (target) {
                const targetId = target.getAttribute('data-target');
                if (targetId === 'step-operator-whatsapp-derivation') {
                    const whatsappNumber = target.getAttribute('data-whatsapp-number');
                    document.getElementById('whatsapp-link').href = `https://wa.me/${whatsappNumber}`;
                }
                navigateToStep(targetId);
            }
        });

        homeButton.addEventListener('click', goToHome);
        backButton.addEventListener('click', goBack);
    </script>

</body>
</html>

